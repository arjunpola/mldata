{% extends "repository/base.html" %}
{% load i18n %}
{% load markup %}
{% load show_stars %}

{% block title %}{% trans "Repository" %} :: {{ object.klass }} :: {{ object.name }}{% endblock %}
{% block breadcrumbs %}<a href="{% url repository_index %}">{% trans "Repository" %}</a> / {{ object.klass }} / {% trans "View" %} / {{ object.name }}{% endblock %}
{% block extrahead %}
<script type="text/javascript" src="/media/js/jquery/jquery.js"></script>
<script type="text/javascript" src="/media/js/jquery/ui.core.js"></script>
<script type="text/javascript" src="/media/js/jquery/ui.tabs.js"></script>
<script type="text/javascript">
$(function() {
	$('#delete').click(function() {
		if (confirm('{% trans "Do you really want to delete this version?" %}')) {
			return true;
		} else {
			return false;
		}
	});

	$('#rating').hover(function() {
		$('#rating-hide').css('visibility', 'visible');
	});
	$('#rating-hide-close').click(function() {
		$('#rating-hide').css('visibility', 'hidden');
		return false;
	});

	$('#contents-tabs').tabs();
});
</script>
{% endblock %}

{% block content %}
<h2 class="title-01">{% trans "View" %} {{ object.name }} ({% if object.is_public %}{% trans "public" %}{% else %}{% trans "private" %}{% endif %})</h2>
<div class="in">
		<div class="item-info">
			{{ object.pub_date|date:"Y-m-d H:i" }} {% trans "by" %} {{ object.user.username }} | {% trans "Version" %} {{ object.version }} | <span id="rating"><a href="#">{% trans "Rating" %}</a> {% show_stars object.average_rating of 5 round to half %}</span>
			<div id="rating-hide">{% include "repository/rating_hide.html" %}</div>
		</div>
		<div class="item-actions">
				{% if can_activate %}<a href="{{ object.url_activate }}" title="{% trans "Make this version current and public" %}">{% trans "ACTIVATE" %}</a>{% endif %}
				<a href="{{ object.url_edit }}" title="{% trans "Edit this version to create a new current one" %}">{% trans "EDIT" %}</a>
				{% if can_delete %}<a id="delete" href="{{ object.url_delete }}" title="{% trans "Delete this version" %}">{% trans "DELETE" %}</a>{% endif %}
		</div>
		<br style="clear:both" />

	<div id="contents-tabs">
		<ul class="item-tabs">
			<li><a title="{% trans "Primary attributes of item + download" %}" href="#contents-tabs-main"><span>{% trans "Main" %}</a><span></li>
{% ifequal object.klass "Data" %}			<li><a title="{% trans "Extracted/parsed/visualised data from the file" %}" href="#contents-tabs-data"><span>{% trans "Data" %}</a><span></li>{% endifequal %}
			<li><a title="{% trans "Other attributes of item" %}" href="#contents-tabs-other"><span>{% trans "Other" %}</a><span></li>
			<li><a title="{% trans "History of item" %}" href="#contents-tabs-history"><span>{% trans "History" %}</a><span></li>
		</ul>&nbsp;<!-- need nbsp; to see first bullet point ... -->

		<div id="contents-tabs-main"><dl id="news">
			<dt>{% trans "Tags" %}</dt>
			<dd>{% for tag in object.tags %}{% if tag %}<a href="{% url repository.views.tags_view tag.strip %}">{{ tag }}</a> {% endif %}{% endfor %}</dd>
			<dt>{% trans "Description" %}</dt>
			<dd>{{ object.description|markdown }}</dd>
			<dt>{% trans "License" %}</dt>
			<dd><a href="{{ object.license.url }}">{{ object.license.name }}</a></dd>
		{% ifequal object.klass "Data" %}
			<dt>{% trans "Download" %}</a></dd>
			<dd><a href="{% url repository.views.data_download object.id %}">{% trans "This File" %}</a></dd>
		{% else %}{% ifequal object.klass "Task" %}
			<dt>{% trans "Input format" %}</dt>
			<dd>{{ object.input|markdown }}</dd>
			<dt>{% trans "Output format" %}</dt>
			<dd>{{ object.output|markdown }}</dd>
			<dt>{% trans "Performance Measure" %}</dt>
			<dd>{{ object.performance_measure|markdown }}</dd>
			<dt>{% trans "Type" %}</dt>
			<dd>{{ object.type }}</dd>
			<dt>{% trans "Data" %}</dt>
			<dd>{% for d in object.data.all %}<a href="{{ d.get_absolute_url }}">{{ d.name }}</a> {% endfor %}</dd>
			{% if object.splits %}
			<dt>{% trans "Download" %}</dt>
			<dd><a href="{% url repository.views.splits_download object.id %}">{% trans "These Splits" %}</a></dd>
			{% endif %}
		{% else %}{% ifequal object.klass "Solution" %}
			<dt>{% trans "Feature Processing" %}</dt>
			<dd>{{ object.feature_processing }}</dd>
			<dt>{% trans "Parameters" %}</dt>
			<dd>{{ object.Parameters }}</dd>
			<dt>{% trans "Operating System" %}</dt>
			<dd>{{ object.os }}</dd>
			<dt>{% trans "Code" %}</dt>
			<dd>{{ object.code|markdown }}</dd>
			<dt>{% trans "Task" %}</dt>
			<dd><a href="{{ object.task.get_absolute_url }}">{{ object.task.name }}</a></dd>
			{% if object.score %}
			<dt>{% trans "Download" %}</dt>
			<dd><a href="{% url repository.views.score_download object.id %}">{% trans "This Score" %}</a></dd>
			{% endif %}
		{% endifequal %}{% endifequal %}{% endifequal %}
		</dl></div><!-- /contents-main -->
		{% ifequal object.klass "Data" %}
		<div id="contents-tabs-data"><dl id="news">
			<dt>{% trans "Format" %}</dt>
			<dd>{{ object.format }}</dd>
			<dt>{% trans "Name" %}</dt>
			<dd>{{ extract.name }}</dd>
			<dt>{% trans "Version" %} mldata</dt>
			<dd>{{ extract.mldata }}</dd>
			<dt>{% trans "Comment" %}</dt>
			<dd>{{ extract.comment }}</dd>
			<dt>{% trans "Attribute Names" %}</dt>
			<dd><ol>
			{% for name in extract.attribute_names %}
				<li>{{ name }}</li>
			{% endfor %}
			</ol></dd>
			<dt>{% trans "Attribute Types" %}</dt>
			<dd><ol>
			{% for type in extract.attribute_types %}
				<li>{{ type }}</li>
			{% endfor %}
			</ol></dd>
			<dt>{% trans "Attributes (extract)" %}</dt>
			<dd><ol>
			{% for attr in extract.attributes %}
				<li>{{ attr|join:' / ' }}</li>
			{% endfor %}
			</ol></dd>
		</dl></div><!-- /contents-data -->
		{% endifequal %}
		<div id="contents-tabs-other"><dl id="news">
			<dt>{% trans "Summary" %}</dt>
			<dd>{{ object.summary }}</dd>
			<dt>{% trans "URLs" %}</dt>
			<dd>{{ object.urls }}</dd>
			<dt>{% trans "Publications" %}</dt>
			<dd>{{ object.publications }}</dd>
		{% ifequal object.klass "Data" %}
			<dt>{% trans "Data Source" %}</dt>
			<dd>{{ object.source }}</dd>
			<dt>{% trans "Measurement Details" %}</dt>
			<dd>{{ object.measurement_details|markdown }}</dd>
			<dt>{% trans "Usage Scenario" %}</dt>
			<dd>{{ object.usage_scenario|markdown }}</dd>
		{% endifequal %}
		</dl></div><!-- /contents-other -->
		<div id="contents-tabs-history">
			{% if object.versions.has_previous %}<a href="?page={{ object.versions.previous_page_number }}#contents-history">&laquo; {% trans "prev" %}</a>{% endif %}
			<dl id="news">{% for v in object.versions.object_list %}
				<dt><a href="{{ request.path }}../{{ v.id }}">{{ v.version }}</a></dt>
				<dd>by {{ v.user }} on {{ v.pub_date|date:"Y-m-d H:i" }}</dd>
			{% endfor %}</dl>
			{% if object.versions.has_next %}<a href="?page={{ object.versions.next_page_number }}#contents-history">{% trans "next" %} &raquo;</a>{% endif %}
		</div><!-- /contents-history -->
	</div><!-- /contents -->

	<div>
		{% trans "Completeness of this item currently" %}: {{ object.completeness }}%.<br />
		{% trans "You can" %} <a href="{{ object.url_edit }}">{% trans "edit this item" %}</a> {% trans "to add more meta information and make use of the site's premium features" %}.
	</div>
</div><!-- /in -->

{% load comments %}
{% ifequal object.klass "Data" %}
{% get_comment_list for repository.data object.id as comment_list %}
{% get_comment_form for repository.data object.id as form %}
{% else %}{% ifequal object.klass "Task" %}
{% get_comment_list for repository.task object.id as comment_list %}
{% get_comment_form for repository.task object.id as form %}
{% else %}{% ifequal object.klass "Solution" %}
{% get_comment_list for repository.solution object.id as comment_list %}
{% get_comment_form for repository.solution object.id as form %}
{% endifequal %}{% endifequal %}{% endifequal %}
{% include "comments/list.html" %}
{% include "comments/form.html" %}

{% endblock %}
