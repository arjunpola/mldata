{% extends "repository/base.html" %}
{% load i18n %}
{% load markup %}

{% block title %}{% trans "Repository" %} :: {{ object.klass }} :: {{ object.name }}{% endblock %}
{% block billboard %}{% trans "Repository" %} :: {{ object.klass }} :: {% trans "View" %}{% endblock %}
{% block extrahead %}
<script type="text/javascript" src="/media/js/jquery/jquery.js"></script>
<script type="text/javascript" src="/media/js/jquery/ui.core.js"></script>
<script type="text/javascript" src="/media/js/jquery/ui.tabs.js"></script>
<script type="text/javascript">
$(function() {
	$('#delete').click(function() {
		if (confirm('{% trans "Do you really want to delete this version?" %}')) {
			return true;
		} else {
			return false;
		}
	});

	$('#contents').tabs();
});
</script>
{% endblock %}

{% block content %}
<table class="plain">
<tr>
	<td width="75%"><h1>{{ object.klass }} {% trans "of" %} {{ object.name }} ({% if object.is_public %}{% trans "public" %}{% else %}{% trans "private" %}{% endif %})</h1></td>
	<td class="rating">{% include "repository/rating_results.html" %}</td>
</tr>
<tr>
	<td colspan="2">{% trans "Completeness of this item currently" %}: {{ object.completeness }}%.<br />{% trans "You can" %}
		<a href="{{ object.url_edit }}">{% trans "edit this item" %}</a> {% trans "to add more meta information and make use of the site's premium features" %}.</td>
</tr>
</table>

<div id="contents" class="widget">
<ul class="head">
	<li><a title="{% trans "Primary attributes of item + download" %}" href="#contents-main">{% trans "Main" %}</a></li>
{% ifequal object.klass "Data" %}
	<li><a title="{% trans "Extracted/parsed/visualised data from the file" %}" href="#contents-data">{% trans "Data" %}</a></li>
{% endifequal %}
	<li><a title="{% trans "Other attributes of item" %}" href="#contents-other">{% trans "Other" %}</a></li>
	<li><a title="{% trans "History of item" %}" href="#contents-history">{% trans "History" %}</a></li>
</ul>
<div class="info">
	{% trans "on" %} {{ object.pub_date|date:"Y-m-d H:i" }} {% trans "by" %} {{ object.user.username }}, {% trans "version" %} {{ object.version }}
</div>
<div class="actions">
		{% if can_activate %}<a href="{{ object.url_activate }}" title="{% trans "Make this version current and public" %}">{% trans "ACTIVATE" %}</a>{% endif %}
		<a href="{{ object.url_edit }}" title="{% trans "Edit this version to create a new current one" %}">{% trans "EDIT" %}</a>
		{% if can_delete %}<a id="delete" href="{{ object.url_delete }}" title="{% trans "Delete this version" %}">{% trans "DELETE" %}</a>{% endif %}
</div>
<br style="clear:both" />

<div id="contents-main">
	<div class="title">{% trans "Tags" %}</div>
	<div class="data">{% for tag in object.tags %}{% if tag %}<a href="{% url repository.views.tags_view tag.strip %}">{{ tag }}</a> {% endif %}{% endfor %}</div>
	<div class="title">{% trans "Description" %}</div>
	<div class="data">{{ object.description|markdown }}</div>
	<div class="title">{% trans "License" %}</div>
	<div class="data"><a href="{{ object.license.url }}">{{ object.license.name }}</a></div>
{% ifequal object.klass "Data" %}
	<div class="title"><a href="{% url repository.views.data_download object.id %}">{% trans "Download Data File" %}</a></div>
{% else %}{% ifequal object.klass "Task" %}
	<div class="title">{% trans "Input format" %}</div>
	<div class="data">{{ object.input|markdown }}</div>
	<div class="title">{% trans "Output format" %}</div>
	<div class="data">{{ object.output|markdown }}</div>
	<div class="title">{% trans "Performance Measure" %}</div>
	<div class="data">{{ object.performance_measure|markdown }}</div>
	<div class="title">{% trans "Type" %}</div>
	<div class="data">{{ object.type }}</div>
	<div class="title">{% trans "Data" %}</div>
	<div class="data">{% for d in object.data.all %}<a href="{{ d.get_absolute_url }}">{{ d.name }}</a> {% endfor %}</div>
	{% if object.splits %}<div class="title"><a href="{% url repository.views.splits_download object.id %}">{% trans "Download Splits" %}</a></div>{% endif %}
{% else %}{% ifequal object.klass "Solution" %}
	<div class="title">{% trans "Feature Processing" %}</div>
	<div class="data">{{ object.feature_processing }}</div>
	<div class="title">{% trans "Parameters" %}</div>
	<div class="data">{{ object.Parameters }}</div>
	<div class="title">{% trans "Operating System" %}</div>
	<div class="data">{{ object.os }}</div>
	<div class="title">{% trans "Code" %}</div>
	<div class="data">{{ object.code|markdown }}</div>
	<div class="title">{% trans "Task" %}</div>
	<div class="data"><a href="{{ object.task.get_absolute_url }}">{{ object.task.name }}</a></div>
	{% if object.score %}<div class="title"><a href="{% url repository.views.score_download object.id %}">{% trans "Download Score" %}</a></div>{% endif %}
{% endifequal %}{% endifequal %}{% endifequal %}
</div>
{% ifequal object.klass "Data" %}
<div id="contents-data">
	<div class="title">{% trans "Format" %}</div>
	<div class="data">{{ object.format }}</div>
	<div class="title">{% trans "Name" %}</div>
	<div class="data">{{ extract.name }}</div>
	<div class="title">{% trans "Version" %} mldata</div>
	<div class="data">{{ extract.mldata }}</div>
	<div class="title">{% trans "Comment" %}</div>
	<div class="data">{{ extract.comment }}</div>
	<div class="title">{% trans "Attribute Names" %}</div>
	<div class="data"><ol>
	{% for name in extract.attribute_names %}
		<li>{{ name }}</li>
	{% endfor %}
	</ol></div>
	<div class="title">{% trans "Attribute Types" %}</div>
	<div class="data"><ol>
	{% for type in extract.attribute_types %}
		<li>{{ type }}</li>
	{% endfor %}
	</ol></div>
	<div class="title">{% trans "Attributes (extract)" %}</div>
	<div class="data"><ol>
	{% for attr in extract.attributes %}
		<li>{{ attr|join:' / ' }}</li>
	{% endfor %}
	</ol></div>
</div>
{% endifequal %}
<div id="contents-other">
	<div class="title">{% trans "Summary" %}</div>
	<div class="data">{{ object.summary }}</div>
	<div class="title">{% trans "URLs" %}</div>
	<div class="data">{{ object.urls }}</div>
	<div class="title">{% trans "Publications" %}</div>
	<div class="data">{{ object.publications }}</div>
{% ifequal object.klass "Data" %}
	<div class="title">{% trans "Data Source" %}</div>
	<div class="data">{{ object.source }}</div>
	<div class="title">{% trans "Measurement Details" %}</div>
	<div class="data">{{ object.measurement_details|markdown }}</div>
	<div class="title">{% trans "Usage Scenario" %}</div>
	<div class="data">{{ object.usage_scenario|markdown }}</div>
{% endifequal %}
</div>
<div id="contents-history">
	{% if object.versions.has_previous %}<a href="?page={{ object.versions.previous_page_number }}#contents-history">&laquo; {% trans "prev" %}</a>{% endif %}
	<ul>{% for v in object.versions.object_list %}
		<li><a href="{{ request.path }}../{{ v.id }}">{{ v.version }}</a> by <a href="{% url user.views.show_user v.user.id %}">{{ v.user }}</a> on {{ v.pub_date|date:"Y-m-d H:i" }}</li><br />
	{% endfor %}</ul>
	{% if object.versions.has_next %}<a href="?page={{ object.versions.next_page_number }}#contents-history">{% trans "next" %} &raquo;</a>{% endif %}
</div>
</div> <!-- // contents -->

{% include "repository/rating_form.html" %}

{% load comments %}
{% ifequal object.klass "Data" %}
{% get_comment_list for repository.data object.id as comment_list %}
{% get_comment_form for repository.data object.id as form %}
{% else %}{% ifequal object.klass "Task" %}
{% get_comment_list for repository.task object.id as comment_list %}
{% get_comment_form for repository.task object.id as form %}
{% else %}{% ifequal object.klass "Solution" %}
{% get_comment_list for repository.solution object.id as comment_list %}
{% get_comment_form for repository.solution object.id as form %}
{% endifequal %}{% endifequal %}{% endifequal %}
{% include "comments/list.html" %}
{% include "comments/form.html" %}

{% endblock %}

