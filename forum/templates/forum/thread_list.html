{% extends "forum_base.html" %}
{% load markup %}
{% load safe_markup %}
{% load i18n %}

{% block title %}{{ forum.title }}{% endblock %}
{% block billboard %}{% trans "Forum" %}: {{ forum.title }}{% endblock %}
{% block pagetitle %}{{ forum.title }}{% endblock %}


{% block content %}
<br>
{% if thread_list %}
<table>
{% if is_paginated %}
<thead><tr>
	<td class="paginator"><a href="?page=1">&laquo;</a> {% for page_number in paginator.page_range %}{% ifequal page_number page %}{{ page_number }}{% else %}<a href="?page={{ page_number }}">{{ page_number }}</a>{% endifequal %} {% endfor %} <a href="?page={{ paginator.num_pages }}">&raquo;</a></td>
</thead></tr>
{% endif %}
    <tr>
        <th>{% trans "Thread" %}</th>
        <th style='width: 50px;'>{% trans "Posts" %}</th>
        <th style='width: 50px;'>{% trans "Views" %}</th>
        <th style='width: 220px;'>{% trans "Last Post" %}</th>
    </tr>

    {% for t in thread_list %}
    <tr>
		<td>{% if t.sticky %}{% trans "Sticky" %} {% endif %}<a href='{{ t.get_absolute_url }}'>{{ t.title }}</a>{% if t.closed %} ({% trans "Closed" %}){% endif %}
		</td>
        <td style='width: 50px;'>{{ t.posts }}</td>
        <td style='width: 50px;'>{{ t.views }}</td>
        <td style='width: 220px;'>{{ t.thread_latest_post.time|timesince }} {% trans "ago by" %} {{ t.thread_latest_post.author }} (<a href='{{ t.thread_latest_post.get_absolute_url }}'>{% trans "view" %}</a>)</td>
    </tr>
    {% endfor %}

{% if is_paginated %}
<tfoot><tr>
	<td class="paginator"><a href="?page=1">&laquo;</a> {% for page_number in paginator.page_range %}{% ifequal page_number page %}{{ page_number }}{% else %}<a href="?page={{ page_number }}">{{ page_number }}</a>{% endifequal %} {% endfor %} <a href="?page={{ paginator.num_pages }}">&raquo;</a></td>
</tfoot></tr>
{% endif %}
</table>
{% endif %}

{% if posting %}
<h2>{% trans "Preview" %}</h2>
<p><b>{% trans "Thread" %}:</b> {{thread.title|escape}}</p>
<div id="threadlist">
    <dl>
        <dt id="post{{ posting.id }}">{{ posting.author }} ( on {{ posting.time|date:"F j, Y, H:i:s" }} )</dt>
    </dl>
    {{ posting.body|markdown:"safe" }}
</div>
{% endif %}

{% if forum.threads %}
<br />
{% endif %}

<dl>
	{% if not user.is_authenticated %}
		{% include "form_login.html" %}
	{% else %}
	<h2>{% trans "Create a new Thread (as" %} {{ user.username }})</h2>
	<form method='post' action='new/'>
		<dt><label for="id_title">{% trans "Title" %}:
		{% if form.title.errors %}
			<span class="error">{{ form.title.errors|join:", " }}</span>
		{% endif %}
		</label></dt>
		<dt>{{ form.title|safe }}</dt>
		<dt><label for="id_body">{% trans "Body" %}:
		{% if form.body.errors %}
			<span class="error">{{ form.body.errors|join:", " }}</span>
		{% endif %}
		</label></dt>
		<dt><textarea id="id_body" rows="8" cols="50" tabindex="1" name="body">{{ form.data.body|safe }}</textarea></dt>
		<dt>{% trans 'You may use <a href="http://daringfireball.net/projects/markdown/syntax" tabindex="3">Markdown syntax</a> here, but <b>raw HTML will be removed</b>' %}.</dt>
		<dt><input type="submit" name="post" value="{% trans "Post Message" %}" tabindex="2" /></dt>
		{% endif %}
	</form>
</dl>
{% endblock %}


{% block content-related %}
<dl><dd>
{% trans "You are in Forum" %} <a href='{{ forum.get_absolute_url }}'><b>{{ forum.title }}</b></a>. {% trans "Choose the thread you would like to read or contribute to. Or simply create a new one if the existing threads do not fit." %}
</dd></dl>


<dl>
    <dd>
    <h3><a href="{% url forum_index %}rss/{{ forum.slug }}"><img src="/media/images/rss.png" alt="RSS Feed" border="0" width="16" height="16" align="top"></img> RSS Feed - "{{ forum.title }}"</a></h3>
      <h3><script type="text/javascript" src="http://w.sharethis.com/button/sharethis.js#tabs=web%2Cemail&amp;charset=utf-8&amp;services=reddit%2Cdigg%2Cdelicious%2Cstumbleupon%2Cyahoo_buzz%2Ctechnorati%2Cgoogle_bmarks%2Cyahoo_bmarks%2Cfurl%2Cslashdot%2Cmagnolia%2Cmister_wong%2Csimpy%2Cyigg&amp;offsetTop=-336&amp;style=default&amp;publisher=85555fbd-bb3a-4ab4-af6f-5dea32a6a5e4"></script></h3> 
    </dd>
</dl>
{% endblock %}
